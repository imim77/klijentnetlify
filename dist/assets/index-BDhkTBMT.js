(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))r(s);new MutationObserver(s=>{for(const i of s)if(i.type==="childList")for(const a of i.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&r(a)}).observe(document,{childList:!0,subtree:!0});function n(s){const i={};return s.integrity&&(i.integrity=s.integrity),s.referrerPolicy&&(i.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?i.credentials="include":s.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function r(s){if(s.ep)return;s.ep=!0;const i=n(s);fetch(s.href,i)}})();const et=!1;var Ot=Array.isArray,In=Array.prototype.indexOf,Te=Array.prototype.includes,Je=Array.from,En=Object.defineProperty,De=Object.getOwnPropertyDescriptor,bn=Object.getOwnPropertyDescriptors,Sn=Object.prototype,Tn=Array.prototype,Mt=Object.getPrototypeOf,gt=Object.isExtensible;const kn=()=>{};function Rn(e){for(var t=0;t<e.length;t++)e[t]()}function Nt(){var e,t,n=new Promise((r,s)=>{e=r,t=s});return{promise:n,resolve:e,reject:t}}const x=2,Xe=4,Ze=8,Dt=1<<24,te=16,J=32,Ce=64,tt=128,H=512,k=1024,P=2048,G=4096,D=8192,oe=16384,ge=32768,ke=65536,wt=1<<17,Ft=1<<18,Ae=1<<19,xn=1<<20,se=1<<25,we=65536,nt=1<<21,at=1<<22,ae=1<<23,Qe=Symbol("$state"),de=new class extends Error{name="StaleReactionError";message="The reaction that called `getAbortSignal()` was re-run or destroyed"};function Pn(e){throw new Error("https://svelte.dev/e/lifecycle_outside_component")}function An(){throw new Error("https://svelte.dev/e/async_derived_orphan")}function On(e,t,n){throw new Error("https://svelte.dev/e/each_key_duplicate")}function Mn(e){throw new Error("https://svelte.dev/e/effect_in_teardown")}function Nn(){throw new Error("https://svelte.dev/e/effect_in_unowned_derived")}function Dn(e){throw new Error("https://svelte.dev/e/effect_orphan")}function Fn(){throw new Error("https://svelte.dev/e/effect_update_depth_exceeded")}function Ln(){throw new Error("https://svelte.dev/e/state_descriptors_fixed")}function Bn(){throw new Error("https://svelte.dev/e/state_prototype_fixed")}function Wn(){throw new Error("https://svelte.dev/e/state_unsafe_mutation")}function qn(){throw new Error("https://svelte.dev/e/svelte_boundary_reset_onerror")}const Hn=1,Un=2,Vn=16,$n=1,jn=2,R=Symbol(),Lt="http://www.w3.org/1999/xhtml";function zn(){console.warn("https://svelte.dev/e/svelte_boundary_reset_noop")}function Bt(e){return e===this.v}function Yn(e,t){return e!=e?t==t:e!==t||e!==null&&typeof e=="object"||typeof e=="function"}function Wt(e){return!Yn(e,this.v)}let Be=!1,Kn=!1;function Gn(){Be=!0}let T=null;function Re(e){T=e}function qt(e,t=!1,n){T={p:T,i:!1,c:null,e:null,s:e,x:null,l:Be&&!t?{s:null,u:null,$:[]}:null}}function Ht(e){var t=T,n=t.e;if(n!==null){t.e=null;for(var r of n)on(r)}return t.i=!0,T=t.p,{}}function We(){return!Be||T!==null&&T.l===null}let Ee=[];function Jn(){var e=Ee;Ee=[],Rn(e)}function Se(e){if(Ee.length===0){var t=Ee;queueMicrotask(()=>{t===Ee&&Jn()})}Ee.push(e)}function Ut(e){var t=y;if(t===null)return w.f|=ae,e;if((t.f&ge)===0&&(t.f&Xe)===0)throw e;ie(e,t)}function ie(e,t){for(;t!==null;){if((t.f&tt)!==0){if((t.f&ge)===0)throw e;try{t.b.error(e);return}catch(n){e=n}}t=t.parent}throw e}const Xn=-7169;function S(e,t){e.f=e.f&Xn|t}function lt(e){(e.f&H)!==0||e.deps===null?S(e,k):S(e,G)}function Vt(e){if(e!==null)for(const t of e)(t.f&x)===0||(t.f&we)===0||(t.f^=we,Vt(t.deps))}function $t(e,t,n){(e.f&P)!==0?t.add(e):(e.f&G)!==0&&n.add(e),Vt(e.deps),S(e,k)}const Ve=new Set;let I=null,z=null,B=[],ft=null,rt=!1;class le{current=new Map;previous=new Map;#t=new Set;#a=new Set;#e=0;#i=0;#n=null;#o=new Set;#r=new Set;#s=new Map;is_fork=!1;#l=!1;#c(){return this.is_fork||this.#i>0}skip_effect(t){this.#s.has(t)||this.#s.set(t,{d:[],m:[]})}unskip_effect(t){var n=this.#s.get(t);if(n){this.#s.delete(t);for(var r of n.d)S(r,P),Y(r);for(r of n.m)S(r,G),Y(r)}}process(t){B=[],this.apply();var n=[],r=[];for(const s of t)this.#f(s,n,r);if(this.#c()){this.#u(r),this.#u(n);for(const[s,i]of this.#s)Yt(s,i)}else{for(const s of this.#t)s();this.#t.clear(),this.#e===0&&this.#h(),I=null,yt(r),yt(n),this.#n?.resolve()}z=null}#f(t,n,r){t.f^=k;for(var s=t.first;s!==null;){var i=s.f,a=(i&(J|Ce))!==0,o=a&&(i&k)!==0,l=o||(i&D)!==0||this.#s.has(s);if(!l&&s.fn!==null){a?s.f^=k:(i&Xe)!==0?n.push(s):He(s)&&((i&te)!==0&&this.#r.add(s),Pe(s));var f=s.first;if(f!==null){s=f;continue}}for(;s!==null;){var h=s.next;if(h!==null){s=h;break}s=s.parent}}}#u(t){for(var n=0;n<t.length;n+=1)$t(t[n],this.#o,this.#r)}capture(t,n){n!==R&&!this.previous.has(t)&&this.previous.set(t,n),(t.f&ae)===0&&(this.current.set(t,t.v),z?.set(t,t.v))}activate(){I=this,this.apply()}deactivate(){I===this&&(I=null,z=null)}flush(){if(this.activate(),B.length>0){if(Zn(),I!==null&&I!==this)return}else this.#e===0&&this.process([]);this.deactivate()}discard(){for(const t of this.#a)t(this);this.#a.clear()}#h(){if(Ve.size>1){this.previous.clear();var t=z,n=!0;for(const s of Ve){if(s===this){n=!1;continue}const i=[];for(const[o,l]of this.current){if(s.current.has(o))if(n&&l!==s.current.get(o))s.current.set(o,l);else continue;i.push(o)}if(i.length===0)continue;const a=[...s.current.keys()].filter(o=>!this.current.has(o));if(a.length>0){var r=B;B=[];const o=new Set,l=new Map;for(const f of i)jt(f,a,o,l);if(B.length>0){I=s,s.apply();for(const f of B)s.#f(f,[],[]);s.deactivate()}B=r}}I=null,z=t}Ve.delete(this)}increment(t){this.#e+=1,t&&(this.#i+=1)}decrement(t){this.#e-=1,t&&(this.#i-=1),!this.#l&&(this.#l=!0,Se(()=>{this.#l=!1,this.#c()?B.length>0&&this.flush():this.revive()}))}revive(){for(const t of this.#o)this.#r.delete(t),S(t,P),Y(t);for(const t of this.#r)S(t,G),Y(t);this.flush()}oncommit(t){this.#t.add(t)}ondiscard(t){this.#a.add(t)}settled(){return(this.#n??=Nt()).promise}static ensure(){if(I===null){const t=I=new le;Ve.add(I),Se(()=>{I===t&&t.flush()})}return I}apply(){}}function Zn(){rt=!0;var e=null;try{for(var t=0;B.length>0;){var n=le.ensure();if(t++>1e3){var r,s;Qn()}n.process(B),fe.clear()}}finally{B=[],rt=!1,ft=null}}function Qn(){try{Fn()}catch(e){ie(e,ft)}}let ee=null;function yt(e){var t=e.length;if(t!==0){for(var n=0;n<t;){var r=e[n++];if((r.f&(oe|D))===0&&He(r)&&(ee=new Set,Pe(r),r.deps===null&&r.first===null&&r.nodes===null&&r.teardown===null&&r.ac===null&&ln(r),ee?.size>0)){fe.clear();for(const s of ee){if((s.f&(oe|D))!==0)continue;const i=[s];let a=s.parent;for(;a!==null;)ee.has(a)&&(ee.delete(a),i.push(a)),a=a.parent;for(let o=i.length-1;o>=0;o--){const l=i[o];(l.f&(oe|D))===0&&Pe(l)}}ee.clear()}}ee=null}}function jt(e,t,n,r){if(!n.has(e)&&(n.add(e),e.reactions!==null))for(const s of e.reactions){const i=s.f;(i&x)!==0?jt(s,t,n,r):(i&(at|te))!==0&&(i&P)===0&&zt(s,t,r)&&(S(s,P),Y(s))}}function zt(e,t,n){const r=n.get(e);if(r!==void 0)return r;if(e.deps!==null)for(const s of e.deps){if(Te.call(t,s))return!0;if((s.f&x)!==0&&zt(s,t,n))return n.set(s,!0),!0}return n.set(e,!1),!1}function Y(e){var t=ft=e,n=t.b;if(n?.is_pending&&(e.f&(Xe|Ze|Dt))!==0&&(e.f&ge)===0){n.defer_effect(e);return}for(;t.parent!==null;){t=t.parent;var r=t.f;if(rt&&t===y&&(r&te)!==0&&(r&Ft)===0&&(r&ge)!==0)return;if((r&(Ce|J))!==0){if((r&k)===0)return;t.f^=k}}B.push(t)}function Yt(e,t){if(!((e.f&J)!==0&&(e.f&k)!==0)){(e.f&P)!==0?t.d.push(e):(e.f&G)!==0&&t.m.push(e),S(e,k);for(var n=e.first;n!==null;)Yt(n,t),n=n.next}}function er(e){let t=0,n=ye(0),r;return()=>{ut()&&(C(n),Er(()=>(t===0&&(r=wn(()=>e(()=>Fe(n)))),t+=1,()=>{Se(()=>{t-=1,t===0&&(r?.(),r=void 0,Fe(n))})})))}}var tr=ke|Ae;function nr(e,t,n,r){new rr(e,t,n,r)}class rr{parent;is_pending=!1;transform_error;#t;#a=null;#e;#i;#n;#o=null;#r=null;#s=null;#l=null;#c=0;#f=0;#u=!1;#h=new Set;#p=new Set;#d=null;#y=er(()=>(this.#d=ye(this.#c),()=>{this.#d=null}));constructor(t,n,r,s){this.#t=t,this.#e=n,this.#i=i=>{var a=y;a.b=this,a.f|=tt,r(i)},this.parent=y.b,this.transform_error=s??this.parent?.transform_error??(i=>i),this.#n=dt(()=>{this.#g()},tr)}#m(){try{this.#o=q(()=>this.#i(this.#t))}catch(t){this.error(t)}}#C(t){const n=this.#e.failed;n&&(this.#s=q(()=>{n(this.#t,()=>t,()=>()=>{})}))}#I(){const t=this.#e.pending;t&&(this.is_pending=!0,this.#r=q(()=>t(this.#t)),Se(()=>{var n=this.#l=document.createDocumentFragment(),r=pe();n.append(r),this.#o=this.#_(()=>(le.ensure(),q(()=>this.#i(r)))),this.#f===0&&(this.#t.before(n),this.#l=null,ve(this.#r,()=>{this.#r=null}),this.#v())}))}#g(){try{if(this.is_pending=this.has_pending_snippet(),this.#f=0,this.#c=0,this.#o=q(()=>{this.#i(this.#t)}),this.#f>0){var t=this.#l=document.createDocumentFragment();un(this.#o,t);const n=this.#e.pending;this.#r=q(()=>n(this.#t))}else this.#v()}catch(n){this.error(n)}}#v(){this.is_pending=!1;for(const t of this.#h)S(t,P),Y(t);for(const t of this.#p)S(t,G),Y(t);this.#h.clear(),this.#p.clear()}defer_effect(t){$t(t,this.#h,this.#p)}is_rendered(){return!this.is_pending&&(!this.parent||this.parent.is_rendered())}has_pending_snippet(){return!!this.#e.pending}#_(t){var n=y,r=w,s=T;Z(this.#n),V(this.#n),Re(this.#n.ctx);try{return t()}catch(i){return Ut(i),null}finally{Z(n),V(r),Re(s)}}#w(t){if(!this.has_pending_snippet()){this.parent&&this.parent.#w(t);return}this.#f+=t,this.#f===0&&(this.#v(),this.#r&&ve(this.#r,()=>{this.#r=null}),this.#l&&(this.#t.before(this.#l),this.#l=null))}update_pending_count(t){this.#w(t),this.#c+=t,!(!this.#d||this.#u)&&(this.#u=!0,Se(()=>{this.#u=!1,this.#d&&xe(this.#d,this.#c)}))}get_effect_pending(){return this.#y(),C(this.#d)}error(t){var n=this.#e.onerror;let r=this.#e.failed;if(!n&&!r)throw t;this.#o&&(M(this.#o),this.#o=null),this.#r&&(M(this.#r),this.#r=null),this.#s&&(M(this.#s),this.#s=null);var s=!1,i=!1;const a=()=>{if(s){zn();return}s=!0,i&&qn(),this.#s!==null&&ve(this.#s,()=>{this.#s=null}),this.#_(()=>{le.ensure(),this.#g()})},o=l=>{try{i=!0,n?.(l,a),i=!1}catch(f){ie(f,this.#n&&this.#n.parent)}r&&(this.#s=this.#_(()=>{le.ensure();try{return q(()=>{var f=y;f.b=this,f.f|=tt,r(this.#t,()=>l,()=>a)})}catch(f){return ie(f,this.#n.parent),null}}))};Se(()=>{var l;try{l=this.transform_error(t)}catch(f){ie(f,this.#n&&this.#n.parent);return}l!==null&&typeof l=="object"&&typeof l.then=="function"?l.then(o,f=>ie(f,this.#n&&this.#n.parent)):o(l)})}}function sr(e,t,n,r){const s=We()?Kt:Gt;var i=e.filter(d=>!d.settled);if(n.length===0&&i.length===0){r(t.map(s));return}var a=y,o=ir(),l=i.length===1?i[0].promise:i.length>1?Promise.all(i.map(d=>d.promise)):null;function f(d){o();try{r(d)}catch(p){(a.f&oe)===0&&ie(p,a)}st()}if(n.length===0){l.then(()=>f(t.map(s)));return}function h(){o(),Promise.all(n.map(d=>ar(d))).then(d=>f([...t.map(s),...d])).catch(d=>ie(d,a))}l?l.then(h):h()}function ir(){var e=y,t=w,n=T,r=I;return function(i=!0){Z(e),V(t),Re(n),i&&r?.activate()}}function st(e=!0){Z(null),V(null),Re(null),e&&I?.deactivate()}function or(){var e=y.b,t=I,n=e.is_rendered();return e.update_pending_count(1),t.increment(n),()=>{e.update_pending_count(-1),t.decrement(n)}}function Kt(e){var t=x|P,n=w!==null&&(w.f&x)!==0?w:null;return y!==null&&(y.f|=Ae),{ctx:T,deps:null,effects:null,equals:Bt,f:t,fn:e,reactions:null,rv:0,v:R,wv:0,parent:n??y,ac:null}}function ar(e,t,n){y===null&&An();var s=void 0,i=ye(R),a=!w,o=new Map;return Ir(()=>{var l=Nt();s=l.promise;try{Promise.resolve(e()).then(l.resolve,l.reject).finally(st)}catch(p){l.reject(p),st()}var f=I;if(a){var h=or();o.get(f)?.reject(de),o.delete(f),o.set(f,l)}const d=(p,v=void 0)=>{if(f.activate(),v)v!==de&&(i.f|=ae,xe(i,v));else{(i.f&ae)!==0&&(i.f^=ae),xe(i,p);for(const[c,_]of o){if(o.delete(c),c===f)break;_.reject(de)}}h&&h()};l.promise.then(d,p=>d(null,p||"unknown"))}),yr(()=>{for(const l of o.values())l.reject(de)}),new Promise(l=>{function f(h){function d(){h===s?l(i):f(s)}h.then(d,d)}f(s)})}function Gt(e){const t=Kt(e);return t.equals=Wt,t}function lr(e){var t=e.effects;if(t!==null){e.effects=null;for(var n=0;n<t.length;n+=1)M(t[n])}}function fr(e){for(var t=e.parent;t!==null;){if((t.f&x)===0)return(t.f&oe)===0?t:null;t=t.parent}return null}function ct(e){var t,n=y;Z(fr(e));try{e.f&=~we,lr(e),t=vn(e)}finally{Z(n)}return t}function Jt(e){var t=ct(e);if(!e.equals(t)&&(e.wv=hn(),(!I?.is_fork||e.deps===null)&&(e.v=t,e.deps===null))){S(e,k);return}me||(z!==null?(ut()||I?.is_fork)&&z.set(e,t):lt(e))}function cr(e){if(e.effects!==null)for(const t of e.effects)(t.teardown||t.ac)&&(t.teardown?.(),t.ac?.abort(de),t.teardown=kn,t.ac=null,Le(t,0),ht(t))}function Xt(e){if(e.effects!==null)for(const t of e.effects)t.teardown&&Pe(t)}let it=new Set;const fe=new Map;let Zt=!1;function ye(e,t){var n={f:0,v:e,reactions:null,equals:Bt,rv:0,wv:0};return n}function j(e,t){const n=ye(e);return Tr(n),n}function ur(e,t=!1,n=!0){const r=ye(e);return t||(r.equals=Wt),Be&&n&&T!==null&&T.l!==null&&(T.l.s??=[]).push(r),r}function A(e,t,n=!1){w!==null&&(!K||(w.f&wt)!==0)&&We()&&(w.f&(x|te|at|wt))!==0&&(U===null||!Te.call(U,e))&&Wn();let r=n?be(t):t;return xe(e,r)}function xe(e,t){if(!e.equals(t)){var n=e.v;me?fe.set(e,t):fe.set(e,n),e.v=t;var r=le.ensure();if(r.capture(e,n),(e.f&x)!==0){const s=e;(e.f&P)!==0&&ct(s),lt(s)}e.wv=hn(),Qt(e,P),We()&&y!==null&&(y.f&k)!==0&&(y.f&(J|Ce))===0&&(L===null?kr([e]):L.push(e)),!r.is_fork&&it.size>0&&!Zt&&dr()}return t}function dr(){Zt=!1;for(const e of it)(e.f&k)!==0&&S(e,G),He(e)&&Pe(e);it.clear()}function Fe(e){A(e,e.v+1)}function Qt(e,t){var n=e.reactions;if(n!==null)for(var r=We(),s=n.length,i=0;i<s;i++){var a=n[i],o=a.f;if(!(!r&&a===y)){var l=(o&P)===0;if(l&&S(a,t),(o&x)!==0){var f=a;z?.delete(f),(o&we)===0&&(o&H&&(a.f|=we),Qt(f,G))}else l&&((o&te)!==0&&ee!==null&&ee.add(a),Y(a))}}}function be(e){if(typeof e!="object"||e===null||Qe in e)return e;const t=Mt(e);if(t!==Sn&&t!==Tn)return e;var n=new Map,r=Ot(e),s=j(0),i=_e,a=o=>{if(_e===i)return o();var l=w,f=_e;V(null),It(i);var h=o();return V(l),It(f),h};return r&&n.set("length",j(e.length)),new Proxy(e,{defineProperty(o,l,f){(!("value"in f)||f.configurable===!1||f.enumerable===!1||f.writable===!1)&&Ln();var h=n.get(l);return h===void 0?a(()=>{var d=j(f.value);return n.set(l,d),d}):A(h,f.value,!0),!0},deleteProperty(o,l){var f=n.get(l);if(f===void 0){if(l in o){const h=a(()=>j(R));n.set(l,h),Fe(s)}}else A(f,R),Fe(s);return!0},get(o,l,f){if(l===Qe)return e;var h=n.get(l),d=l in o;if(h===void 0&&(!d||De(o,l)?.writable)&&(h=a(()=>{var v=be(d?o[l]:R),c=j(v);return c}),n.set(l,h)),h!==void 0){var p=C(h);return p===R?void 0:p}return Reflect.get(o,l,f)},getOwnPropertyDescriptor(o,l){var f=Reflect.getOwnPropertyDescriptor(o,l);if(f&&"value"in f){var h=n.get(l);h&&(f.value=C(h))}else if(f===void 0){var d=n.get(l),p=d?.v;if(d!==void 0&&p!==R)return{enumerable:!0,configurable:!0,value:p,writable:!0}}return f},has(o,l){if(l===Qe)return!0;var f=n.get(l),h=f!==void 0&&f.v!==R||Reflect.has(o,l);if(f!==void 0||y!==null&&(!h||De(o,l)?.writable)){f===void 0&&(f=a(()=>{var p=h?be(o[l]):R,v=j(p);return v}),n.set(l,f));var d=C(f);if(d===R)return!1}return h},set(o,l,f,h){var d=n.get(l),p=l in o;if(r&&l==="length")for(var v=f;v<d.v;v+=1){var c=n.get(v+"");c!==void 0?A(c,R):v in o&&(c=a(()=>j(R)),n.set(v+"",c))}if(d===void 0)(!p||De(o,l)?.writable)&&(d=a(()=>j(void 0)),A(d,be(f)),n.set(l,d));else{p=d.v!==R;var _=a(()=>be(f));A(d,_)}var m=Reflect.getOwnPropertyDescriptor(o,l);if(m?.set&&m.set.call(h,f),!p){if(r&&typeof l=="string"){var b=n.get("length"),E=Number(l);Number.isInteger(E)&&E>=b.v&&A(b,E+1)}Fe(s)}return!0},ownKeys(o){C(s);var l=Reflect.ownKeys(o).filter(d=>{var p=n.get(d);return p===void 0||p.v!==R});for(var[f,h]of n)h.v!==R&&!(f in o)&&l.push(f);return l},setPrototypeOf(){Bn()}})}var mt,en,tn,nn;function hr(){if(mt===void 0){mt=window,en=/Firefox/.test(navigator.userAgent);var e=Element.prototype,t=Node.prototype,n=Text.prototype;tn=De(t,"firstChild").get,nn=De(t,"nextSibling").get,gt(e)&&(e.__click=void 0,e.__className=void 0,e.__attributes=null,e.__style=void 0,e.__e=void 0),gt(n)&&(n.__t=void 0)}}function pe(e=""){return document.createTextNode(e)}function Ge(e){return tn.call(e)}function qe(e){return nn.call(e)}function W(e,t){return Ge(e)}function pr(e,t=!1){{var n=Ge(e);return n instanceof Comment&&n.data===""?qe(n):n}}function ue(e,t=1,n=!1){let r=e;for(;t--;)r=qe(r);return r}function vr(e){e.textContent=""}function rn(){return!1}function _r(e,t,n){return document.createElementNS(Lt,e,void 0)}function sn(e){var t=w,n=y;V(null),Z(null);try{return e()}finally{V(t),Z(n)}}function gr(e){y===null&&(w===null&&Dn(),Nn()),me&&Mn()}function wr(e,t){var n=t.last;n===null?t.last=t.first=e:(n.next=e,e.prev=n,t.last=e)}function ce(e,t,n){var r=y;r!==null&&(r.f&D)!==0&&(e|=D);var s={ctx:T,deps:null,nodes:null,f:e|P|H,first:null,fn:t,last:null,next:null,parent:r,b:r&&r.b,prev:null,teardown:null,wv:0,ac:null};if(n)try{Pe(s)}catch(o){throw M(s),o}else t!==null&&Y(s);var i=s;if(n&&i.deps===null&&i.teardown===null&&i.nodes===null&&i.first===i.last&&(i.f&Ae)===0&&(i=i.first,(e&te)!==0&&(e&ke)!==0&&i!==null&&(i.f|=ke)),i!==null&&(i.parent=r,r!==null&&wr(i,r),w!==null&&(w.f&x)!==0&&(e&Ce)===0)){var a=w;(a.effects??=[]).push(i)}return s}function ut(){return w!==null&&!K}function yr(e){const t=ce(Ze,null,!1);return S(t,k),t.teardown=e,t}function mr(e){gr();var t=y.f,n=!w&&(t&J)!==0&&(t&ge)===0;if(n){var r=T;(r.e??=[]).push(e)}else return on(e)}function on(e){return ce(Xe|xn,e,!1)}function Cr(e){le.ensure();const t=ce(Ce|Ae,e,!0);return(n={})=>new Promise(r=>{n.outro?ve(t,()=>{M(t),r(void 0)}):(M(t),r(void 0))})}function Ir(e){return ce(at|Ae,e,!0)}function Er(e,t=0){return ce(Ze|t,e,!0)}function Ye(e,t=[],n=[],r=[]){sr(r,t,n,s=>{ce(Ze,()=>e(...s.map(C)),!0)})}function dt(e,t=0){var n=ce(te|t,e,!0);return n}function q(e){return ce(J|Ae,e,!0)}function an(e){var t=e.teardown;if(t!==null){const n=me,r=w;Ct(!0),V(null);try{t.call(null)}finally{Ct(n),V(r)}}}function ht(e,t=!1){var n=e.first;for(e.first=e.last=null;n!==null;){const s=n.ac;s!==null&&sn(()=>{s.abort(de)});var r=n.next;(n.f&Ce)!==0?n.parent=null:M(n,t),n=r}}function br(e){for(var t=e.first;t!==null;){var n=t.next;(t.f&J)===0&&M(t),t=n}}function M(e,t=!0){var n=!1;(t||(e.f&Ft)!==0)&&e.nodes!==null&&e.nodes.end!==null&&(Sr(e.nodes.start,e.nodes.end),n=!0),ht(e,t&&!n),Le(e,0),S(e,oe);var r=e.nodes&&e.nodes.t;if(r!==null)for(const i of r)i.stop();an(e);var s=e.parent;s!==null&&s.first!==null&&ln(e),e.next=e.prev=e.teardown=e.ctx=e.deps=e.fn=e.nodes=e.ac=null}function Sr(e,t){for(;e!==null;){var n=e===t?null:qe(e);e.remove(),e=n}}function ln(e){var t=e.parent,n=e.prev,r=e.next;n!==null&&(n.next=r),r!==null&&(r.prev=n),t!==null&&(t.first===e&&(t.first=r),t.last===e&&(t.last=n))}function ve(e,t,n=!0){var r=[];fn(e,r,!0);var s=()=>{n&&M(e),t&&t()},i=r.length;if(i>0){var a=()=>--i||s();for(var o of r)o.out(a)}else s()}function fn(e,t,n){if((e.f&D)===0){e.f^=D;var r=e.nodes&&e.nodes.t;if(r!==null)for(const o of r)(o.is_global||n)&&t.push(o);for(var s=e.first;s!==null;){var i=s.next,a=(s.f&ke)!==0||(s.f&J)!==0&&(e.f&te)!==0;fn(s,t,a?n:!1),s=i}}}function pt(e){cn(e,!0)}function cn(e,t){if((e.f&D)!==0){e.f^=D,(e.f&k)===0&&(S(e,P),Y(e));for(var n=e.first;n!==null;){var r=n.next,s=(n.f&ke)!==0||(n.f&J)!==0;cn(n,s?t:!1),n=r}var i=e.nodes&&e.nodes.t;if(i!==null)for(const a of i)(a.is_global||t)&&a.in()}}function un(e,t){if(e.nodes)for(var n=e.nodes.start,r=e.nodes.end;n!==null;){var s=n===r?null:qe(n);t.append(n),n=s}}let Ke=!1,me=!1;function Ct(e){me=e}let w=null,K=!1;function V(e){w=e}let y=null;function Z(e){y=e}let U=null;function Tr(e){w!==null&&(U===null?U=[e]:U.push(e))}let O=null,N=0,L=null;function kr(e){L=e}let dn=1,he=0,_e=he;function It(e){_e=e}function hn(){return++dn}function He(e){var t=e.f;if((t&P)!==0)return!0;if(t&x&&(e.f&=~we),(t&G)!==0){for(var n=e.deps,r=n.length,s=0;s<r;s++){var i=n[s];if(He(i)&&Jt(i),i.wv>e.wv)return!0}(t&H)!==0&&z===null&&S(e,k)}return!1}function pn(e,t,n=!0){var r=e.reactions;if(r!==null&&!(U!==null&&Te.call(U,e)))for(var s=0;s<r.length;s++){var i=r[s];(i.f&x)!==0?pn(i,t,!1):t===i&&(n?S(i,P):(i.f&k)!==0&&S(i,G),Y(i))}}function vn(e){var t=O,n=N,r=L,s=w,i=U,a=T,o=K,l=_e,f=e.f;O=null,N=0,L=null,w=(f&(J|Ce))===0?e:null,U=null,Re(e.ctx),K=!1,_e=++he,e.ac!==null&&(sn(()=>{e.ac.abort(de)}),e.ac=null);try{e.f|=nt;var h=e.fn,d=h();e.f|=ge;var p=e.deps,v=I?.is_fork;if(O!==null){var c;if(v||Le(e,N),p!==null&&N>0)for(p.length=N+O.length,c=0;c<O.length;c++)p[N+c]=O[c];else e.deps=p=O;if(ut()&&(e.f&H)!==0)for(c=N;c<p.length;c++)(p[c].reactions??=[]).push(e)}else!v&&p!==null&&N<p.length&&(Le(e,N),p.length=N);if(We()&&L!==null&&!K&&p!==null&&(e.f&(x|G|P))===0)for(c=0;c<L.length;c++)pn(L[c],e);if(s!==null&&s!==e){if(he++,s.deps!==null)for(let _=0;_<n;_+=1)s.deps[_].rv=he;if(t!==null)for(const _ of t)_.rv=he;L!==null&&(r===null?r=L:r.push(...L))}return(e.f&ae)!==0&&(e.f^=ae),d}catch(_){return Ut(_)}finally{e.f^=nt,O=t,N=n,L=r,w=s,U=i,Re(a),K=o,_e=l}}function Rr(e,t){let n=t.reactions;if(n!==null){var r=In.call(n,e);if(r!==-1){var s=n.length-1;s===0?n=t.reactions=null:(n[r]=n[s],n.pop())}}if(n===null&&(t.f&x)!==0&&(O===null||!Te.call(O,t))){var i=t;(i.f&H)!==0&&(i.f^=H,i.f&=~we),lt(i),cr(i),Le(i,0)}}function Le(e,t){var n=e.deps;if(n!==null)for(var r=t;r<n.length;r++)Rr(e,n[r])}function Pe(e){var t=e.f;if((t&oe)===0){S(e,k);var n=y,r=Ke;y=e,Ke=!0;try{(t&(te|Dt))!==0?br(e):ht(e),an(e);var s=vn(e);e.teardown=typeof s=="function"?s:null,e.wv=dn;var i;et&&Kn&&(e.f&P)!==0&&e.deps}finally{Ke=r,y=n}}}function C(e){var t=e.f,n=(t&x)!==0;if(w!==null&&!K){var r=y!==null&&(y.f&oe)!==0;if(!r&&(U===null||!Te.call(U,e))){var s=w.deps;if((w.f&nt)!==0)e.rv<he&&(e.rv=he,O===null&&s!==null&&s[N]===e?N++:O===null?O=[e]:O.push(e));else{(w.deps??=[]).push(e);var i=e.reactions;i===null?e.reactions=[w]:Te.call(i,w)||i.push(w)}}}if(me&&fe.has(e))return fe.get(e);if(n){var a=e;if(me){var o=a.v;return((a.f&k)===0&&a.reactions!==null||gn(a))&&(o=ct(a)),fe.set(a,o),o}var l=(a.f&H)===0&&!K&&w!==null&&(Ke||(w.f&H)!==0),f=(a.f&ge)===0;He(a)&&(l&&(a.f|=H),Jt(a)),l&&!f&&(Xt(a),_n(a))}if(z?.has(e))return z.get(e);if((e.f&ae)!==0)throw e.v;return e.v}function _n(e){if(e.f|=H,e.deps!==null)for(const t of e.deps)(t.reactions??=[]).push(e),(t.f&x)!==0&&(t.f&H)===0&&(Xt(t),_n(t))}function gn(e){if(e.v===R)return!0;if(e.deps===null)return!1;for(const t of e.deps)if(fe.has(t)||(t.f&x)!==0&&gn(t))return!0;return!1}function wn(e){var t=K;try{return K=!0,e()}finally{K=t}}const xr=["touchstart","touchmove"];function Pr(e){return xr.includes(e)}const $e=Symbol("events"),Ar=new Set,Et=new Set;let bt=null;function St(e){var t=this,n=t.ownerDocument,r=e.type,s=e.composedPath?.()||[],i=s[0]||e.target;bt=e;var a=0,o=bt===e&&e[$e];if(o){var l=s.indexOf(o);if(l!==-1&&(t===document||t===window)){e[$e]=t;return}var f=s.indexOf(t);if(f===-1)return;l<=f&&(a=l)}if(i=s[a]||e.target,i!==t){En(e,"currentTarget",{configurable:!0,get(){return i||n}});var h=w,d=y;V(null),Z(null);try{for(var p,v=[];i!==null;){var c=i.assignedSlot||i.parentNode||i.host||null;try{var _=i[$e]?.[r];_!=null&&(!i.disabled||e.target===i)&&_.call(i,e)}catch(m){p?v.push(m):p=m}if(e.cancelBubble||c===t||c===null)break;i=c}if(p){for(let m of v)queueMicrotask(()=>{throw m});throw p}}finally{e[$e]=t,delete e.currentTarget,V(h),Z(d)}}}const Or=globalThis?.window?.trustedTypes&&globalThis.window.trustedTypes.createPolicy("svelte-trusted-html",{createHTML:e=>e});function Mr(e){return Or?.createHTML(e)??e}function Nr(e){var t=_r("template");return t.innerHTML=Mr(e.replaceAll("<!>","<!---->")),t.content}function Tt(e,t){var n=y;n.nodes===null&&(n.nodes={start:e,end:t,a:null,t:null})}function Oe(e,t){var n=(t&$n)!==0,r=(t&jn)!==0,s,i=!e.startsWith("<!>");return()=>{s===void 0&&(s=Nr(i?e:"<!>"+e),n||(s=Ge(s)));var a=r||en?document.importNode(s,!0):s.cloneNode(!0);if(n){var o=Ge(a),l=a.lastChild;Tt(o,l)}else Tt(a,a);return a}}function Ie(e,t){e!==null&&e.before(t)}function je(e,t){var n=t==null?"":typeof t=="object"?t+"":t;n!==(e.__t??=e.nodeValue)&&(e.__t=n,e.nodeValue=n+"")}function Dr(e,t){return Fr(e,t)}const ze=new Map;function Fr(e,{target:t,anchor:n,props:r={},events:s,context:i,intro:a=!0,transformError:o}){hr();var l=void 0,f=Cr(()=>{var h=n??t.appendChild(pe());nr(h,{pending:()=>{}},v=>{qt({});var c=T;i&&(c.c=i),s&&(r.$$events=s),l=e(v,r)||{},Ht()},o);var d=new Set,p=v=>{for(var c=0;c<v.length;c++){var _=v[c];if(!d.has(_)){d.add(_);var m=Pr(_);for(const $ of[t,document]){var b=ze.get($);b===void 0&&(b=new Map,ze.set($,b));var E=b.get(_);E===void 0?($.addEventListener(_,St,{passive:m}),b.set(_,1)):b.set(_,E+1)}}}};return p(Je(Ar)),Et.add(p),()=>{for(var v of d)for(const m of[t,document]){var c=ze.get(m),_=c.get(v);--_==0?(m.removeEventListener(v,St),c.delete(v),c.size===0&&ze.delete(m)):c.set(v,_)}Et.delete(p),h!==n&&h.parentNode?.removeChild(h)}});return Lr.set(l,f),l}let Lr=new WeakMap;class Br{anchor;#t=new Map;#a=new Map;#e=new Map;#i=new Set;#n=!0;constructor(t,n=!0){this.anchor=t,this.#n=n}#o=()=>{var t=I;if(this.#t.has(t)){var n=this.#t.get(t),r=this.#a.get(n);if(r)pt(r),this.#i.delete(n);else{var s=this.#e.get(n);s&&(this.#a.set(n,s.effect),this.#e.delete(n),s.fragment.lastChild.remove(),this.anchor.before(s.fragment),r=s.effect)}for(const[i,a]of this.#t){if(this.#t.delete(i),i===t)break;const o=this.#e.get(a);o&&(M(o.effect),this.#e.delete(a))}for(const[i,a]of this.#a){if(i===n||this.#i.has(i))continue;const o=()=>{if(Array.from(this.#t.values()).includes(i)){var f=document.createDocumentFragment();un(a,f),f.append(pe()),this.#e.set(i,{effect:a,fragment:f})}else M(a);this.#i.delete(i),this.#a.delete(i)};this.#n||!r?(this.#i.add(i),ve(a,o,!1)):o()}}};#r=t=>{this.#t.delete(t);const n=Array.from(this.#t.values());for(const[r,s]of this.#e)n.includes(r)||(M(s.effect),this.#e.delete(r))};ensure(t,n){var r=I,s=rn();if(n&&!this.#a.has(t)&&!this.#e.has(t))if(s){var i=document.createDocumentFragment(),a=pe();i.append(a),this.#e.set(t,{effect:q(()=>n(a)),fragment:i})}else this.#a.set(t,q(()=>n(this.anchor)));if(this.#t.set(r,t),s){for(const[o,l]of this.#a)o===t?r.unskip_effect(l):r.skip_effect(l);for(const[o,l]of this.#e)o===t?r.unskip_effect(l.effect):r.skip_effect(l.effect);r.oncommit(this.#o),r.ondiscard(this.#r)}else this.#o()}}function kt(e,t,n=!1){var r=new Br(e),s=n?ke:0;function i(a,o){r.ensure(a,o)}dt(()=>{var a=!1;t((o,l=0)=>{a=!0,i(l,o)}),a||i(!1,null)},s)}function Wr(e,t){return t}function qr(e,t,n){for(var r=[],s=t.length,i,a=t.length,o=0;o<s;o++){let d=t[o];ve(d,()=>{if(i){if(i.pending.delete(d),i.done.add(d),i.pending.size===0){var p=e.outrogroups;ot(Je(i.done)),p.delete(i),p.size===0&&(e.outrogroups=null)}}else a-=1},!1)}if(a===0){var l=r.length===0&&n!==null;if(l){var f=n,h=f.parentNode;vr(h),h.append(f),e.items.clear()}ot(t,!l)}else i={pending:new Set(t),done:new Set},(e.outrogroups??=new Set).add(i)}function ot(e,t=!0){for(var n=0;n<e.length;n++)M(e[n],t)}var Rt;function Hr(e,t,n,r,s,i=null){var a=e,o=new Map;{var l=e;a=l.appendChild(pe())}var f=null,h=Gt(()=>{var m=n();return Ot(m)?m:m==null?[]:Je(m)}),d,p=!0;function v(){_.fallback=f,Ur(_,d,a,t,r),f!==null&&(d.length===0?(f.f&se)===0?pt(f):(f.f^=se,Ne(f,null,a)):ve(f,()=>{f=null}))}var c=dt(()=>{d=C(h);for(var m=d.length,b=new Set,E=I,$=rn(),F=0;F<m;F+=1){var X=d[F],ne=r(X,F),u=p?null:o.get(ne);u?(u.v&&xe(u.v,X),u.i&&xe(u.i,F),$&&E.unskip_effect(u.e)):(u=Vr(o,p?a:Rt??=pe(),X,ne,F,s,t,n),p||(u.e.f|=se),o.set(ne,u)),b.add(ne)}if(m===0&&i&&!f&&(p?f=q(()=>i(a)):(f=q(()=>i(Rt??=pe())),f.f|=se)),m>b.size&&On(),!p)if($){for(const[g,Q]of o)b.has(g)||E.skip_effect(Q.e);E.oncommit(v),E.ondiscard(()=>{})}else v();C(h)}),_={effect:c,items:o,outrogroups:null,fallback:f};p=!1}function Me(e){for(;e!==null&&(e.f&J)===0;)e=e.next;return e}function Ur(e,t,n,r,s){var i=t.length,a=e.items,o=Me(e.effect.first),l,f=null,h=[],d=[],p,v,c,_;for(_=0;_<i;_+=1){if(p=t[_],v=s(p,_),c=a.get(v).e,e.outrogroups!==null)for(const g of e.outrogroups)g.pending.delete(c),g.done.delete(c);if((c.f&se)!==0)if(c.f^=se,c===o)Ne(c,null,n);else{var m=f?f.next:o;c===e.effect.last&&(e.effect.last=c.prev),c.prev&&(c.prev.next=c.next),c.next&&(c.next.prev=c.prev),re(e,f,c),re(e,c,m),Ne(c,m,n),f=c,h=[],d=[],o=Me(f.next);continue}if((c.f&D)!==0&&pt(c),c!==o){if(l!==void 0&&l.has(c)){if(h.length<d.length){var b=d[0],E;f=b.prev;var $=h[0],F=h[h.length-1];for(E=0;E<h.length;E+=1)Ne(h[E],b,n);for(E=0;E<d.length;E+=1)l.delete(d[E]);re(e,$.prev,F.next),re(e,f,$),re(e,F,b),o=b,f=F,_-=1,h=[],d=[]}else l.delete(c),Ne(c,o,n),re(e,c.prev,c.next),re(e,c,f===null?e.effect.first:f.next),re(e,f,c),f=c;continue}for(h=[],d=[];o!==null&&o!==c;)(l??=new Set).add(o),d.push(o),o=Me(o.next);if(o===null)continue}(c.f&se)===0&&h.push(c),f=c,o=Me(c.next)}if(e.outrogroups!==null){for(const g of e.outrogroups)g.pending.size===0&&(ot(Je(g.done)),e.outrogroups?.delete(g));e.outrogroups.size===0&&(e.outrogroups=null)}if(o!==null||l!==void 0){var X=[];if(l!==void 0)for(c of l)(c.f&D)===0&&X.push(c);for(;o!==null;)(o.f&D)===0&&o!==e.fallback&&X.push(o),o=Me(o.next);var ne=X.length;if(ne>0){var u=i===0?n:null;qr(e,X,u)}}}function Vr(e,t,n,r,s,i,a,o){var l=(a&Hn)!==0?(a&Vn)===0?ur(n,!1,!1):ye(n):null,f=(a&Un)!==0?ye(s):null;return{v:l,i:f,e:q(()=>(i(t,l??n,f??s,o),()=>{e.delete(r)}))}}function Ne(e,t,n){if(e.nodes)for(var r=e.nodes.start,s=e.nodes.end,i=t&&(t.f&se)===0?t.nodes.start:n;r!==null;){var a=qe(r);if(i.before(r),r===s)return;r=a}}function re(e,t,n){t===null?e.effect.first=n:t.next=n,n===null?e.effect.last=t:n.prev=t}const $r=Symbol("is custom element"),jr=Symbol("is html");function xt(e,t,n,r){var s=zr(e);s[t]!==(s[t]=n)&&(n==null?e.removeAttribute(t):typeof n!="string"&&Yr(e).includes(t)?e[t]=n:e.setAttribute(t,n))}function zr(e){return e.__attributes??={[$r]:e.nodeName.includes("-"),[jr]:e.namespaceURI===Lt}}var Pt=new Map;function Yr(e){var t=e.getAttribute("is")||e.nodeName,n=Pt.get(t);if(n)return n;Pt.set(t,n=[]);for(var r,s=e,i=Element.prototype;i!==s;){r=bn(s);for(var a in r)r[a].set&&n.push(a);s=Mt(s)}return n}function Kr(e){T===null&&Pn(),Be&&T.l!==null?Gr(T).m.push(e):mr(()=>{const t=wn(e);if(typeof t=="function")return t})}function Gr(e){var t=e.l;return t.u??={a:[],b:[],m:[]}}const Jr="5";typeof window<"u"&&((window.__svelte??={}).v??=new Set).add(Jr);Gn();const Xr="data:image/svg+xml,%3csvg%20xmlns='http://www.w3.org/2000/svg'%20xmlns:xlink='http://www.w3.org/1999/xlink'%20aria-hidden='true'%20role='img'%20class='iconify%20iconify--logos'%20width='26.6'%20height='32'%20preserveAspectRatio='xMidYMid%20meet'%20viewBox='0%200%20256%20308'%3e%3cpath%20fill='%23FF3E00'%20d='M239.682%2040.707C211.113-.182%20154.69-12.301%20113.895%2013.69L42.247%2059.356a82.198%2082.198%200%200%200-37.135%2055.056a86.566%2086.566%200%200%200%208.536%2055.576a82.425%2082.425%200%200%200-12.296%2030.719a87.596%2087.596%200%200%200%2014.964%2066.244c28.574%2040.893%2084.997%2053.007%20125.787%2027.016l71.648-45.664a82.182%2082.182%200%200%200%2037.135-55.057a86.601%2086.601%200%200%200-8.53-55.577a82.409%2082.409%200%200%200%2012.29-30.718a87.573%2087.573%200%200%200-14.963-66.244'%3e%3c/path%3e%3cpath%20fill='%23FFF'%20d='M106.889%20270.841c-23.102%206.007-47.497-3.036-61.103-22.648a52.685%2052.685%200%200%201-9.003-39.85a49.978%2049.978%200%200%201%201.713-6.693l1.35-4.115l3.671%202.697a92.447%2092.447%200%200%200%2028.036%2014.007l2.663.808l-.245%202.659a16.067%2016.067%200%200%200%202.89%2010.656a17.143%2017.143%200%200%200%2018.397%206.828a15.786%2015.786%200%200%200%204.403-1.935l71.67-45.672a14.922%2014.922%200%200%200%206.734-9.977a15.923%2015.923%200%200%200-2.713-12.011a17.156%2017.156%200%200%200-18.404-6.832a15.78%2015.78%200%200%200-4.396%201.933l-27.35%2017.434a52.298%2052.298%200%200%201-14.553%206.391c-23.101%206.007-47.497-3.036-61.101-22.649a52.681%2052.681%200%200%201-9.004-39.849a49.428%2049.428%200%200%201%2022.34-33.114l71.664-45.677a52.218%2052.218%200%200%201%2014.563-6.398c23.101-6.007%2047.497%203.036%2061.101%2022.648a52.685%2052.685%200%200%201%209.004%2039.85a50.559%2050.559%200%200%201-1.713%206.692l-1.35%204.116l-3.67-2.693a92.373%2092.373%200%200%200-28.037-14.013l-2.664-.809l.246-2.658a16.099%2016.099%200%200%200-2.89-10.656a17.143%2017.143%200%200%200-18.398-6.828a15.786%2015.786%200%200%200-4.402%201.935l-71.67%2045.674a14.898%2014.898%200%200%200-6.73%209.975a15.9%2015.9%200%200%200%202.709%2012.012a17.156%2017.156%200%200%200%2018.404%206.832a15.841%2015.841%200%200%200%204.402-1.935l27.345-17.427a52.147%2052.147%200%200%201%2014.552-6.397c23.101-6.006%2047.497%203.037%2061.102%2022.65a52.681%2052.681%200%200%201%209.003%2039.848a49.453%2049.453%200%200%201-22.34%2033.12l-71.664%2045.673a52.218%2052.218%200%200%201-14.563%206.398'%3e%3c/path%3e%3c/svg%3e",Zr="/vite.svg";class At{pc=null;dc=null;signaling;peerId;sessionId;isConnected=!1;isCaller=!1;iceServers=[];pendingCandidates=[];lastConnectionState=null;constructor({signaling:t,peerId:n,sessionId:r}){this.signaling=t,this.peerId=n,this.sessionId=r}createPeerConnection(){if(this.pc)return;const t={iceServers:this.iceServers.map(n=>({urls:n.urls,username:n.username,credential:n.credential}))};this.pc=new RTCPeerConnection(t),console.log("[WebRTC] create peer connection",{sessionId:this.sessionId,peerId:this.peerId,isCaller:this.isCaller,iceServers:this.iceServers}),this.pc.onicecandidate=n=>{n.candidate&&(console.log("[WebRTC] local ICE candidate",{sessionId:this.sessionId,peerId:this.peerId}),this.signaling.send({type:"CANDIDATE",sessionId:this.sessionId,target:this.peerId,candidate:n.candidate}))},this.pc.onconnectionstatechange=()=>{const n=this.pc?.connectionState;console.log("[WebRTC] connection state:",n,{sessionId:this.sessionId,peerId:this.peerId}),!(!n||n===this.lastConnectionState)&&(this.lastConnectionState=n,n==="connected"?(this.isConnected=!0,console.log("[WebRTC] peer connected",{sessionId:this.sessionId,peerId:this.peerId,role:this.isCaller?"caller":"callee"}),this.logSelectedCandidatePair()):(n==="disconnected"||n==="failed"||n==="closed")&&(this.isConnected=!1,console.warn("[WebRTC] peer not connected",{state:n,sessionId:this.sessionId,peerId:this.peerId,role:this.isCaller?"caller":"callee"})))},this.pc.oniceconnectionstatechange=()=>{console.log("[WebRTC] ICE connection state:",this.pc?.iceConnectionState,{sessionId:this.sessionId,peerId:this.peerId})},this.pc.ondatachannel=n=>{this.setupDataChannel(n.channel)},this.isCaller&&this.createDataChannel(),this.isCaller&&this.createOffer()}setupDataChannel(t){this.dc=t,t.binaryType="arraybuffer",t.onopen=()=>{console.log("Data channel opened")},t.onmessage=n=>{console.log("Data channel message:",n.data)},t.onclose=()=>{console.log("Data channel closed")},t.onerror=n=>{console.error("Data channel error: ",n)}}createDataChannel(){if(!this.pc||this.dc)return;const t=this.pc.createDataChannel("data",{ordered:!0});this.setupDataChannel(t)}async createOffer(){if(this.pc)try{const t=await this.pc.createOffer();await this.pc.setLocalDescription(t),console.log("[WebRTC] sending offer",{sessionId:this.sessionId,peerId:this.peerId}),this.signaling.send({type:"OFFER",sessionId:this.sessionId,target:this.peerId,sdp:t.sdp})}catch(t){console.error("Failed to create offer: ",t)}}async HandlerOffer(t){if(this.pc||this.createPeerConnection(),!!this.pc)try{console.log("[WebRTC] received offer",{sessionId:this.sessionId,peerId:this.peerId}),await this.pc.setRemoteDescription(t),await this.flushPendingCandidates();const n=await this.pc.createAnswer();await this.pc.setLocalDescription(n),console.log("[WebRTC] sending answer",{sessionId:this.sessionId,peerId:this.peerId}),this.signaling.send({type:"ANSWER",sessionId:this.sessionId,target:this.peerId,sdp:n.sdp})}catch(n){console.error("Failed to handle offer:",n)}}async HandleAnswer(t){if(this.pc)try{console.log("[WebRTC] received answer",{sessionId:this.sessionId,peerId:this.peerId}),await this.pc.setRemoteDescription(t),await this.flushPendingCandidates()}catch(n){console.error("Failed to handle answer:",n)}}async HandleCandidate(t){if(this.pc)try{const n=t instanceof RTCIceCandidate?t.toJSON():t;if(!n?.candidate)return;if(!this.pc.remoteDescription){console.log("[WebRTC] queue remote ICE candidate until remote description",{sessionId:this.sessionId,peerId:this.peerId}),this.pendingCandidates.push(n);return}const r=new RTCIceCandidate(n);console.log("[WebRTC] add remote ICE candidate",{sessionId:this.sessionId,peerId:this.peerId}),await this.pc.addIceCandidate(r)}catch(n){console.error("Failed to add ICE candidate",n)}}destroy(){this.dc&&(this.dc.onopen=null,this.dc.onmessage=null,this.dc.onclose=null,this.dc.onerror=null,this.dc.close(),this.dc=null),this.pc&&(this.pc.onicecandidate=null,this.pc.onconnectionstatechange=null,this.pc.ondatachannel=null,this.pc.close(),this.pc=null),this.isConnected=!1,this.lastConnectionState=null,this.pendingCandidates=[]}async flushPendingCandidates(){if(!this.pc||!this.pc.remoteDescription||this.pendingCandidates.length===0)return;const t=this.pendingCandidates;this.pendingCandidates=[];for(const n of t)try{console.log("[WebRTC] flush queued ICE candidate",{sessionId:this.sessionId,peerId:this.peerId}),await this.pc.addIceCandidate(new RTCIceCandidate(n))}catch(r){console.error("Failed to flush ICE candidate",r)}}async logSelectedCandidatePair(){if(this.pc)try{const t=await this.pc.getStats(),n=[];t.forEach(r=>{r.type==="transport"&&n.push(r)});for(const r of n){const s=r.selectedCandidatePairId;if(!s)continue;const i=t.get(s);if(!i||i.type!=="candidate-pair")continue;const a=t.get(i.localCandidateId),o=t.get(i.remoteCandidateId),l=a,f=o;console.log("[WebRTC] selected ICE candidate pair",{sessionId:this.sessionId,peerId:this.peerId,local:a?`${l.protocol??"unknown"}:${l.address??"unknown"}:${l.port??"unknown"}`:"unknown",remote:o?`${f.protocol??"unknown"}:${f.address??"unknown"}:${f.port??"unknown"}`:"unknown",currentRoundTripTime:i.currentRoundTripTime});return}console.log("[WebRTC] selected ICE candidate pair unavailable",{sessionId:this.sessionId,peerId:this.peerId})}catch(t){console.warn("[WebRTC] failed to read ICE candidate pair stats",{sessionId:this.sessionId,peerId:this.peerId,error:t})}}}class Qr{signaling;peersBySessionId=new Map;pendingCandidatesBySessionId=new Map;_onPeerCreated;_onPeerRemoved;_onError;constructor(t){this.signaling=t.signaling,this._onPeerCreated=t.onPeerCreated,this._onPeerRemoved=t.onPeerRemoved,this._onError=t.onError}startSession(t,n=crypto.randomUUID()){const r=this.peersBySessionId.get(n);if(r)return r;console.log("[PeerManager] start session",{sessionId:n,peerId:t});const s=new At({signaling:this.signaling,peerId:t,sessionId:n});return s.isCaller=!0,s.iceServers=this.signaling.getIceServers(),s.createPeerConnection(),this.peersBySessionId.set(n,s),this._onPeerCreated?.(s),s}async handleMessage(t){switch(console.log("[PeerManager] handle message",t.type),t.type){case"HELLO":this._refreshIceServers();return;case"OFFER":await this._handleOffer(t);return;case"ANSWER":await this._handleAnswer(t.sessionId,t.sdp);return;case"CANDIDATE":await this._handleCandidate(t.sessionId,t.candidate);return;case"LEFT":this.removePeerByPeerId(t.peerId);return;default:return}}removePeerByPeerId(t){for(const[n,r]of this.peersBySessionId.entries())r.peerId===t&&(r.destroy(),this.peersBySessionId.delete(n),this.pendingCandidatesBySessionId.delete(n),this._onPeerRemoved?.(r))}destroy(){for(const t of this.peersBySessionId.values())t.destroy(),this._onPeerRemoved?.(t);this.peersBySessionId.clear(),this.pendingCandidatesBySessionId.clear()}_refreshIceServers(){const t=this.signaling.getIceServers();for(const n of this.peersBySessionId.values())n.pc||(n.iceServers=t)}async _handleOffer(t){let n=this.peersBySessionId.get(t.sessionId);n||(n=new At({signaling:this.signaling,peerId:t.peer.id,sessionId:t.sessionId}),n.isCaller=!1,n.iceServers=this.signaling.getIceServers(),this.peersBySessionId.set(t.sessionId,n),this._onPeerCreated?.(n));try{await n.HandlerOffer({type:"offer",sdp:t.sdp}),await this._flushPendingCandidates(t.sessionId,n)}catch(r){this._onError?.(r)}}async _handleAnswer(t,n){const r=this.peersBySessionId.get(t);if(r)try{await r.HandleAnswer({type:"answer",sdp:n})}catch(s){this._onError?.(s)}}async _handleCandidate(t,n){if(!n)return;const r=this.peersBySessionId.get(t);if(!r){const s=this.pendingCandidatesBySessionId.get(t)??[];s.push(n),this.pendingCandidatesBySessionId.set(t,s);return}try{await r.HandleCandidate(n)}catch(s){this._onError?.(s)}}async _flushPendingCandidates(t,n){const r=this.pendingCandidatesBySessionId.get(t);if(!(!r||r.length===0)){this.pendingCandidatesBySessionId.delete(t);for(const s of r)await n.HandleCandidate(s)}}}class es{socket=null;info;url=this._endpoint;_iceServers=[];_reconnectTimer=null;_isDestroyed=!1;_onOpen;_onMessage;_onClose;_onError;constructor(t){this.info=t.info??null,this._onOpen=t.onOpen,this._onMessage=t.onMessage,this._onClose=t.onClose,this._onError=t.onError,this._connect()}send(t){return this._isConnected()?(this.socket.send(JSON.stringify(t)),!0):!1}getIceServers(){return this._iceServers}destroy(){this._isDestroyed=!0,this._clearReconnectTimer(),this.socket&&(this.socket.onopen=null,this.socket.onmessage=null,this.socket.onerror=null,this.socket.onclose=null,this.socket.close(),this.socket=null)}_connect(){if(this._isDestroyed||this._isConnected()||this._isConnecting())return;this._clearReconnectTimer();const t=new WebSocket(this.url);t.onopen=()=>{this.info&&this.send({type:"UPDATE",info:this.info}),this._onOpen?.()},t.onmessage=n=>{let r;try{r=JSON.parse(n.data)}catch(s){this._onError?.(s);return}r.type==="HELLO"&&r.iceServers&&(this._iceServers=r.iceServers),this._onMessage?.(r)},t.onerror=n=>{this._onError?.(n)},t.onclose=n=>{this._handleClose(n)},this.socket=t}_handleClose(t){this.socket=null,this._onClose?.(t),!this._isDestroyed&&(this._clearReconnectTimer(),this._reconnectTimer=setTimeout(()=>this._connect(),5e3))}get _endpoint(){return"https://apigotesting.onrender.com/ws"}_isConnected(){return this.socket!==null&&this.socket.readyState===WebSocket.OPEN}_isConnecting(){return this.socket!==null&&this.socket.readyState===WebSocket.CONNECTING}_clearReconnectTimer(){this._reconnectTimer&&(clearTimeout(this._reconnectTimer),this._reconnectTimer=null)}}var ts=Oe("<p>No peers online.</p>"),ns=Oe("<li><strong> </strong> <code> </code></li>"),rs=Oe("<ul></ul>"),ss=Oe("<p> </p>"),is=Oe("<section><h2>Signaling</h2> <p> </p></section> <section><h2>Peers</h2> <!></section> <!>",1);function os(e,t){qt(t,!0);let n=null,r=null,s=j(null),i=j(be([])),a=j("");function o(u){return C(s)?C(s).id.localeCompare(u)<0:!1}function l(u){if(!r)return!1;for(const g of r.peersBySessionId.values())if(g.peerId===u)return!0;return!1}function f(u){if(C(s)&&u.id===C(s).id)return;const g=C(i).findIndex(Ue=>Ue.id===u.id);if(g<0){A(i,[...C(i),u],!0);return}const Q=C(i).slice();Q[g]=u,A(i,Q,!0)}function h(u){A(i,C(i).filter(g=>g.id!==u),!0)}async function d(u){switch(console.log("[WS] incoming:",u.type,u),await r?.handleMessage(u),u.type){case"HELLO":A(s,u.client,!0),A(i,u.peers.filter(g=>g.id!==u.client.id),!0);for(const g of C(i))p(g.id,!0);break;case"JOIN":f(u.peer),p(u.peer.id,!0);break;case"UPDATE":f(u.peer);break;case"LEFT":h(u.peerId);break}}function p(u,g=!1){if(!r)return;if(g&&!o(u)){console.log("[AUTO CONNECT] skipping (wait for remote offer):",u);return}if(l(u)){console.log("[CONNECT] session already exists:",u);return}console.log(g?"[AUTO CONNECT] starting session to:":"[CONNECT] starting session to:",u),r.startSession(u)}Kr(()=>(n=new es({info:{alias:`Browser-${Math.floor(Math.random()*1e3)}`,deviceType:"Browser"},onOpen:()=>{console.log("[WS] connected to signaling server")},onMessage:async u=>{try{await d(u)}catch(g){A(a,g instanceof Error?g.message:String(g),!0),console.error("Failed to handle WS message:",g)}},onClose:u=>{console.log("[WS] signaling closed:",u.code,u.reason)},onError:u=>{A(a,u instanceof Error?u.message:String(u),!0),console.error("Signaling error:",u)}}),r=new Qr({signaling:n,onPeerCreated:u=>{console.log("[PeerManager] peer session created",{sessionId:u.sessionId,peerId:u.peerId,isCaller:u.isCaller})},onPeerRemoved:u=>{console.log("[PeerManager] peer session removed",{sessionId:u.sessionId,peerId:u.peerId})},onError:u=>{A(a,u instanceof Error?u.message:String(u),!0),console.error("Peer manager error:",u)}}),()=>{r?.destroy(),n?.destroy()}));var v=is(),c=pr(v),_=ue(W(c),2),m=W(_),b=ue(c,2),E=ue(W(b),2);{var $=u=>{var g=ts();Ie(u,g)},F=u=>{var g=rs();Hr(g,21,()=>C(i),Wr,(Q,Ue)=>{var vt=ns(),_t=W(vt),yn=W(_t),mn=ue(_t,2),Cn=W(mn);Ye(()=>{je(yn,C(Ue).alias||"Anonymous"),je(Cn,C(Ue).id)}),Ie(Q,vt)}),Ie(u,g)};kt(E,u=>{C(i).length===0?u($):u(F,!1)})}var X=ue(b,2);{var ne=u=>{var g=ss(),Q=W(g);Ye(()=>je(Q,`Last error: ${C(a)??""}`)),Ie(u,g)};kt(X,u=>{C(a)&&u(ne)})}Ye(()=>je(m,`Me: ${C(s)?`${C(s).alias||"Anonymous"} (${C(s).id})`:"Connecting..."}`)),Ie(e,v),Ht()}var as=Oe('<main><div><a href="https://vite.dev" target="_blank" rel="noreferrer"><img class="logo svelte-1n46o8q" alt="Vite Logo"/></a> <a href="https://svelte.dev" target="_blank" rel="noreferrer"><img class="logo svelte svelte-1n46o8q" alt="Svelte Logo"/></a></div> <h1>Vite + Svelte</h1> <div class="card"><!></div> <p>Check out <a href="https://github.com/sveltejs/kit#readme" target="_blank" rel="noreferrer">SvelteKit</a>, the official Svelte app framework powered by Vite!</p> <p class="read-the-docs svelte-1n46o8q">Click on the Vite and Svelte logos to learn more</p></main>');function ls(e){var t=as(),n=W(t),r=W(n),s=W(r),i=ue(r,2),a=W(i),o=ue(n,4),l=W(o);os(l,{}),Ye(()=>{xt(s,"src",Zr),xt(a,"src",Xr)}),Ie(e,t)}Dr(ls,{target:document.getElementById("app")});
